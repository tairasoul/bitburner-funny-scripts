import { getReactKey } from "/react-handlers/get_react_key";
var sizes;
(function (sizes) {
    sizes[sizes["Smallest"] = 9] = "Smallest";
    sizes[sizes["Small"] = 16] = "Small";
    sizes[sizes["Medium"] = 25] = "Medium";
    sizes[sizes["Large"] = 36] = "Large";
})(sizes || (sizes = {}));
function turnIntoGrid(items) {
    const size = getSize(items);
    if (size != undefined) {
        return createGrid(items, size);
    }
    throw new Error(`Could not turn array of length ${items.length} into grid.`);
}
function createGrid(items, size) {
    const grid = [];
    const limit = size == sizes.Smallest ? 3 : size == sizes.Small ? 4 : size == sizes.Medium ? 5 : 6;
    console.log(limit);
    let index = 0;
    for (let i = 0; i < limit; i++) {
        grid.push([]);
        for (let j = 0; j < limit; j++) {
            grid[i].push(items[index]);
            index++;
        }
    }
    return grid;
}
function generateInstructions(currentPosition, targetPosition) {
    const instructions = [];
    let [currentRow, currentColumn] = currentPosition;
    const [targetRow, targetColumn] = targetPosition;
    while (currentRow !== targetRow || currentColumn !== targetColumn) {
        if (currentRow < targetRow) {
            instructions.push("ArrowDown");
            currentRow++;
        }
        else if (currentRow > targetRow) {
            instructions.push("ArrowUp");
            currentRow--;
        }
        if (currentColumn < targetColumn) {
            instructions.push("ArrowRight");
            currentColumn++;
        }
        else if (currentColumn > targetColumn) {
            instructions.push("ArrowLeft");
            currentColumn--;
        }
    }
    instructions.push(" ");
    return instructions;
}
function getSize(items) {
    if (items.length == 6 * 6)
        return sizes.Large;
    if (items.length == 5 * 5)
        return sizes.Medium;
    if (items.length == 4 * 4)
        return sizes.Small;
    if (items.length == 3 * 3)
        return sizes.Smallest;
    return;
}
function findTarget(grid, target) {
    for (let i = 0; i < grid.length; i++) {
        for (let j = 0; j < grid[i].length; j++) {
            if (grid[i][j].textContent === target) {
                return [i, j];
            }
        }
    }
    return null;
}
export async function SolveSymbols(ns) {
    const doc = eval("document");
    const answerElement = doc.querySelector("#root > div.MuiBox-root > div > div > div:nth-child(3)");
    const targetElement = answerElement.querySelector("h5");
    const targets = targetElement.querySelectorAll("span");
    const symbolContainer = answerElement.querySelector("div");
    const symbols = symbolContainer.querySelectorAll("p");
    const grid = turnIntoGrid(Array.from(symbols));
    const reactKey = getReactKey(answerElement, "Props$");
    // @ts-ignore
    const keyDown = answerElement[reactKey].children[4].props.onKeyDown;
    let currentRow = 0;
    let currentColumn = 0;
    for (const target of targets) {
        await ns.sleep(200);
        const targetString = target.textContent.trim();
        const targetCoords = findTarget(grid, targetString);
        console.log(targetString);
        console.log(targetCoords);
        if (targetCoords) {
            const instructions = generateInstructions([currentRow, currentColumn], targetCoords);
            console.log([currentColumn, currentRow], targetCoords, instructions);
            currentRow = targetCoords[1];
            currentColumn = targetCoords[0];
            for (const instruction of instructions) {
                await ns.sleep(150);
                const event = {
                    preventDefault: () => { },
                    key: instruction,
                    isTrusted: true,
                    target: answerElement,
                    currentTarget: answerElement,
                    bubbles: true,
                    cancelable: true
                };
                keyDown(event);
            }
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ltYm9scy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9pbmZpbC1jaGVhdGluZy9oYW5kbGVycy9zeW1ib2xzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUU1RCxJQUFLLEtBS0o7QUFMRCxXQUFLLEtBQUs7SUFDTix5Q0FBYyxDQUFBO0lBQ2Qsb0NBQVcsQ0FBQTtJQUNYLHNDQUFZLENBQUE7SUFDWixvQ0FBVyxDQUFBO0FBQ2YsQ0FBQyxFQUxJLEtBQUssS0FBTCxLQUFLLFFBS1Q7QUFFRCxTQUFTLFlBQVksQ0FBSSxLQUFVO0lBQy9CLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM1QixJQUFJLElBQUksSUFBSSxTQUFTLEVBQUU7UUFDbkIsT0FBTyxVQUFVLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFBO0tBQ2pDO0lBQ0QsTUFBTSxJQUFJLEtBQUssQ0FBQyxrQ0FBa0MsS0FBSyxDQUFDLE1BQU0sYUFBYSxDQUFDLENBQUM7QUFDakYsQ0FBQztBQUVELFNBQVMsVUFBVSxDQUFJLEtBQVUsRUFBRSxJQUFXO0lBQzFDLE1BQU0sSUFBSSxHQUFVLEVBQUUsQ0FBQztJQUN2QixNQUFNLEtBQUssR0FBRyxJQUFJLElBQUksS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFDakcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNuQixJQUFJLEtBQUssR0FBRyxDQUFDLENBQUM7SUFDZCxLQUFLLElBQUksQ0FB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QkFBb0IsQ0FBQyxDQUFDLFVBQVUsRUFBRSxhQUFhLENBQUMsRUFBRSxZQUFZLENBQUMsQ0FBQztZQUNyRixPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsYUFBYSxFQUFFLFVBQVUsQ0FBQyxFQUFFLFlBQVksRUFBRSxZQUFZLENBQUMsQ0FBQztZQUNyRSxVQUFVLEdBQUcsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzdCLGFBQWEsR0FBRyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEMsS0FBSyxNQUFNLFdBQVcsSUFBSSxZQUFZLEVBQUU7Z0JBQ3BDLE1BQU0sRUFBRSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDcEIsTUFBTSxLQUFLLEdBQUc7b0JBQ1YsY0FBYyxFQUFFLEdBQUcsRUFBRSxHQUFFLENBQUM7b0JBQ3hCLEdBQUcsRUFBRSxXQUFXO29CQUNoQixTQUFTLEVBQUUsSUFBSTtvQkFDZixNQUFNLEVBQUUsYUFBYTtvQkFDckIsYUFBYSxFQUFFLGFBQWE7b0JBQzVCLE9BQU8sRUFBRSxJQUFJO29CQUNiLFVBQVUsRUFBRSxJQUFJO2lCQUNuQixDQUFBO2dCQUNELE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNsQjtTQUNKO0tBQ0o7QUFDTCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTlMgfSBmcm9tIFwiQG5zXCI7XG5pbXBvcnQgeyBnZXRSZWFjdEtleSB9IGZyb20gXCIvcmVhY3QtaGFuZGxlcnMvZ2V0X3JlYWN0X2tleVwiO1xuXG5lbnVtIHNpemVzIHtcbiAgICBTbWFsbGVzdCA9IDMqMyxcbiAgICBTbWFsbCA9IDQqNCxcbiAgICBNZWRpdW0gPSA1KjUsXG4gICAgTGFyZ2UgPSA2KjZcbn1cblxuZnVuY3Rpb24gdHVybkludG9HcmlkPFQ+KGl0ZW1zOiBUW10pIHtcbiAgICBjb25zdCBzaXplID0gZ2V0U2l6ZShpdGVtcyk7XG4gICAgaWYgKHNpemUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVHcmlkKGl0ZW1zLCBzaXplKVxuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCB0dXJuIGFycmF5IG9mIGxlbmd0aCAke2l0ZW1zLmxlbmd0aH0gaW50byBncmlkLmApO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVHcmlkPFQ+KGl0ZW1zOiBUW10sIHNpemU6IHNpemVzKTogVFtdW10ge1xuICAgIGNvbnN0IGdyaWQ6IFRbXVtdID0gW107XG4gICAgY29uc3QgbGltaXQgPSBzaXplID09IHNpemVzLlNtYWxsZXN0ID8gMyA6IHNpemUgPT0gc2l6ZXMuU21hbGwgPyA0IDogc2l6ZSA9PSBzaXplcy5NZWRpdW0gPyA1IDogNlxuICAgIGNvbnNvbGUubG9nKGxpbWl0KTtcbiAgICBsZXQgaW5kZXggPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGltaXQ7IGkrKykge1xuICAgICAgICBncmlkLnB1c2goW10pO1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGxpbWl0OyBqKyspIHtcbiAgICAgICAgICAgIGdyaWRbaV0ucHVzaChpdGVtc1tpbmRleF0pO1xuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZ3JpZDtcbn1cbmZ1bmN0aW9uIGdlbmVyYXRlSW5zdHJ1Y3Rpb25zKGN1cnJlbnRQb3NpdGlvbjogW251bWJlciwgbnVtYmVyXSwgdGFyZ2V0UG9zaXRpb246IFtudW1iZXIsIG51bWJlcl0pOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaW5zdHJ1Y3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgIGxldCBbY3VycmVudFJvdywgY3VycmVudENvbHVtbl0gPSBjdXJyZW50UG9zaXRpb247XG4gICAgY29uc3QgW3RhcmdldFJvdywgdGFyZ2V0Q29sdW1uXSA9IHRhcmdldFBvc2l0aW9uO1xuXG4gICAgd2hpbGUgKGN1cnJlbnRSb3cgIT09IHRhcmdldFJvdyB8fCBjdXJyZW50Q29sdW1uICE9PSB0YXJnZXRDb2x1bW4pIHtcbiAgICAgICAgaWYgKGN1cnJlbnRSb3cgPCB0YXJnZXRSb3cpIHtcbiAgICAgICAgICAgIGluc3RydWN0aW9ucy5wdXNoKFwiQXJyb3dEb3duXCIpO1xuICAgICAgICAgICAgY3VycmVudFJvdysrO1xuICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRSb3cgPiB0YXJnZXRSb3cpIHtcbiAgICAgICAgICAgIGluc3RydWN0aW9ucy5wdXNoKFwiQXJyb3dVcFwiKTtcbiAgICAgICAgICAgIGN1cnJlbnRSb3ctLTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjdXJyZW50Q29sdW1uIDwgdGFyZ2V0Q29sdW1uKSB7XG4gICAgICAgICAgICBpbnN0cnVjdGlvbnMucHVzaChcIkFycm93UmlnaHRcIik7XG4gICAgICAgICAgICBjdXJyZW50Q29sdW1uKys7XG4gICAgICAgIH0gZWxzZSBpZiAoY3VycmVudENvbHVtbiA+IHRhcmdldENvbHVtbikge1xuICAgICAgICAgICAgaW5zdHJ1Y3Rpb25zLnB1c2goXCJBcnJvd0xlZnRcIik7XG4gICAgICAgICAgICBjdXJyZW50Q29sdW1uLS07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpbnN0cnVjdGlvbnMucHVzaChcIiBcIik7XG5cbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb25zO1xufVxuXG5mdW5jdGlvbiBnZXRTaXplKGl0ZW1zOiBhbnlbXSkge1xuICAgIGlmIChpdGVtcy5sZW5ndGggPT0gNio2KVxuICAgICAgICByZXR1cm4gc2l6ZXMuTGFyZ2U7XG4gICAgaWYgKGl0ZW1zLmxlbmd0aCA9PSA1KjUpXG4gICAgICAgIHJldHVybiBzaXplcy5NZWRpdW07XG4gICAgaWYgKGl0ZW1zLmxlbmd0aCA9PSA0KjQpXG4gICAgICAgIHJldHVybiBzaXplcy5TbWFsbDtcbiAgICBpZiAoaXRlbXMubGVuZ3RoID09IDMqMylcbiAgICAgICAgcmV0dXJuIHNpemVzLlNtYWxsZXN0O1xuICAgIHJldHVybjtcbn1cblxuZnVuY3Rpb24gZmluZFRhcmdldDxUIGV4dGVuZHMgSFRNTEVsZW1lbnQ+KGdyaWQ6IFRbXVtdLCB0YXJnZXQ6IHN0cmluZyk6IFtudW1iZXIsIG51bWJlcl0gfCBudWxsIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdyaWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBncmlkW2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICBpZiAoZ3JpZFtpXVtqXS50ZXh0Q29udGVudCA9PT0gdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtpLCBqXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFNvbHZlU3ltYm9scyhuczogTlMpIHtcbiAgICBjb25zdCBkb2MgPSBldmFsKFwiZG9jdW1lbnRcIikgYXMgRG9jdW1lbnQ7XG4gICAgY29uc3QgYW5zd2VyRWxlbWVudCA9IGRvYy5xdWVyeVNlbGVjdG9yKFwiI3Jvb3QgPiBkaXYuTXVpQm94LXJvb3QgPiBkaXYgPiBkaXYgPiBkaXY6bnRoLWNoaWxkKDMpXCIpIGFzIEhUTUxFbGVtZW50O1xuICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBhbnN3ZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoNVwiKSBhcyBIVE1MRWxlbWVudDtcbiAgICBjb25zdCB0YXJnZXRzID0gdGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic3BhblwiKTtcbiAgICBjb25zdCBzeW1ib2xDb250YWluZXIgPSBhbnN3ZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJkaXZcIikgYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29uc3Qgc3ltYm9scyA9IHN5bWJvbENvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFwicFwiKTtcbiAgICBjb25zdCBncmlkID0gdHVybkludG9HcmlkKEFycmF5LmZyb20oc3ltYm9scykpO1xuICAgIGNvbnN0IHJlYWN0S2V5ID0gZ2V0UmVhY3RLZXkoYW5zd2VyRWxlbWVudCwgXCJQcm9wcyRcIik7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IGtleURvd24gPSBhbnN3ZXJFbGVtZW50W3JlYWN0S2V5XS5jaGlsZHJlbls0XS5wcm9wcy5vbktleURvd247XG5cbiAgICBsZXQgY3VycmVudFJvdyA9IDA7XG4gICAgbGV0IGN1cnJlbnRDb2x1bW4gPSAwO1xuXG4gICAgZm9yIChjb25zdCB0YXJnZXQgb2YgdGFyZ2V0cykge1xuICAgICAgICBhd2FpdCBucy5zbGVlcCgyMDApXG4gICAgICAgIGNvbnN0IHRhcmdldFN0cmluZyA9ICh0YXJnZXQudGV4dENvbnRlbnQgYXMgc3RyaW5nKS50cmltKCk7XG4gICAgICAgIGNvbnN0IHRhcmdldENvb3JkcyA9IGZpbmRUYXJnZXQoZ3JpZCwgdGFyZ2V0U3RyaW5nKTtcbiAgICAgICAgY29uc29sZS5sb2codGFyZ2V0U3RyaW5nKTtcbiAgICAgICAgY29uc29sZS5sb2codGFyZ2V0Q29vcmRzKTtcbiAgICAgICAgaWYgKHRhcmdldENvb3Jkcykge1xuICAgICAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25zID0gZ2VuZXJhdGVJbnN0cnVjdGlvbnMoW2N1cnJlbnRSb3csIGN1cnJlbnRDb2x1bW5dLCB0YXJnZXRDb29yZHMpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coW2N1cnJlbnRDb2x1bW4sIGN1cnJlbnRSb3ddLCB0YXJnZXRDb29yZHMsIGluc3RydWN0aW9ucyk7XG4gICAgICAgICAgICBjdXJyZW50Um93ID0gdGFyZ2V0Q29vcmRzWzFdO1xuICAgICAgICAgICAgY3VycmVudENvbHVtbiA9IHRhcmdldENvb3Jkc1swXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaW5zdHJ1Y3Rpb24gb2YgaW5zdHJ1Y3Rpb25zKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgbnMuc2xlZXAoMTUwKTtcbiAgICAgICAgICAgICAgICBjb25zdCBldmVudCA9IHtcbiAgICAgICAgICAgICAgICAgICAgcHJldmVudERlZmF1bHQ6ICgpID0+IHt9LFxuICAgICAgICAgICAgICAgICAgICBrZXk6IGluc3RydWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICBpc1RydXN0ZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogYW5zd2VyRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhcmdldDogYW5zd2VyRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBrZXlEb3duKGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0iXX0=